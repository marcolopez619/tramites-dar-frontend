<div class="main-page" fxLayout='column' fxLayoutAlign="center center"  >
    <header fxFlexFill>
        <mat-toolbar color="primary" fxLayout="row" class="main-toolbar">
            <img class="main-logo" src="../../assets/logo.png" alt="">
            <button mat-icon-button (click)="sidenav.toggle()">
                <mat-icon>menu</mat-icon>
            </button>ï¿¼

            <div fxFlex="90" ><h1>{{ contextoService.getConfig('nombreSistema') }}</h1></div>
            
            <a fxFlex="10" fxFlexLayoutAlign="center end" mat-button routerLink="/login"  *ngIf="!authService.isUserAuthenticated()"><mat-icon>input</mat-icon> {{langService.getLang(eModulo.Base,'loginMensaje')}}</a>
            <a fxFlex="10" mat-button (click)="authService.logoutUser()"  *ngIf="authService.isUserAuthenticated()"><mat-icon class="transform_icon">input</mat-icon> {{langService.getLang(eModulo.Base,'logoutMensaje')}}</a>
        </mat-toolbar>
    </header>

    <mat-sidenav-container fxFlex="1" class="main-container-nav" fxLayout="column">
        <mat-sidenav #sidenav mode="push" opened="false" >
            <mat-accordion>
                <mat-expansion-panel hideToggle="true">
                    <mat-expansion-panel-header class="mat-accent" >
                        <mat-panel-title >
                            {{ langService.getLang(eModulo.Base ,'tit-info-sistema') }}
                        </mat-panel-title>
                        <mat-panel-description>
                            <span class=flex-spacer></span>
                            <mat-icon>settings</mat-icon>
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <mat-list dense>
                        <mat-list-item>
                            <mat-icon matListIcon>apps</mat-icon>
                            <span>{{ contextoService.getConfig('nombreSistema') }}</span>
                        </mat-list-item>
                        
                        <mat-list-item>
                                <mat-icon matListIcon>date_range</mat-icon>
                                <span>{{ utilService.getFechaActual() | date:'dd/MM/yyyy' }}</span>
                        </mat-list-item>

                        <mat-list-item *ngIf="contextoService.getUsuario() != null">
                                <mat-icon matListIcon>account_circle</mat-icon>
                                <span>{{ contextoService.getUsuario()  }}</span>
                        </mat-list-item>

                        <mat-list-item *ngIf="contextoService.getInstitucion() != null">
                                <mat-icon matListIcon>work</mat-icon>
                                <span>{{ contextoService.getInstitucion()  }}</span>
                        </mat-list-item>

                        <mat-list-item *ngIf="contextoService.esMultiIdioma()">
                                <mat-form-field >
                                    <mat-select (selectionChange)="contextoService.setNuevoIdioma($event.value)" placeholder="{{ langService.getLang(eModulo.Base ,'lbl-lenguaje') }}">
                                        <mat-option *ngFor="let idioma of contextoService.getIdiomas()" [value]="idioma.id">
                                        {{ idioma.etiqueta }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                        </mat-list-item>
                    </mat-list>
                    
                </mat-expansion-panel>
                
                <mat-expansion-panel hideToggle="true" *ngFor="let modulo of contextoService.getListaModulos()" >
                    <mat-expansion-panel-header class="mat-accent" >
                        <mat-panel-title >
                            {{modulo.Etiqueta}}
                        </mat-panel-title>
                        <mat-panel-description>
                                <span class=flex-spacer></span>
                                <mat-icon>{{ modulo.Imagen }}</mat-icon>
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <mat-list dense *ngFor="let recurso of modulo.RecursosHijos" (click)="sidenav.toggle()" >
                        <h3 mat-subheader color="primary">{{ recurso.Descripcion}}</h3>
                        <mat-list-item *ngFor="let subrecurso of recurso.RecursosHijos"  >
                                <mat-icon matListIcon>chevron_right</mat-icon>
                            <a routerLink="{{subrecurso.Ejecutable}}" class="accordion-list" >{{subrecurso.Descripcion}}</a>
                        </mat-list-item>
                    </mat-list>
                    
                </mat-expansion-panel>
            </mat-accordion>
            <mat-divider></mat-divider>
        </mat-sidenav>
        <router-outlet></router-outlet>
    </mat-sidenav-container>

    <footer fxFlexFill>
        <mat-toolbar fxLayout="row" fxLayoutAlign="center center" color="primary" class="main-footer" >
            {{ langService.getLang(eModulo.Base ,'msg-copyright') }} |  {{ langService.getLang(eModulo.Base ,'msg-version') }} {{ contextoService.getConfig('versionSistema') }}
        </mat-toolbar>
    </footer>
</div>